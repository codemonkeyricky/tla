
% \begin{document}

\chapter{Data Structure}

Like other languages, TLA+ provides its data structure. I assume the readers are
already familiar with common data structure, and this chapter will only focus on
the TLA+ language semantics. 

\section{Set}

This is the most common data structure used in TLA+ spec. The following is a few examples on
how a set can be used:\newline
\begin{tla}
a == {0, 1, 2}
b == {2, 3, 4}
c == a \union b         \* \{0, 1, 2, 3, 4\}
d == a \intersect b     \* \{2\}
e == \E x \in c: x > 3  \* TRUE - because 4 in c is bigger than 3
f == \E x \in c: x > 5  \* FALSE - nothing in c is bigger than 5
g == \A x \in c: x < 3  \* FALSE - not all elements in c are smaller than 3
h == \A x \in c: x < 5  \* TRUE - all elements in c are smaller than 3
i == {x \in c: x < 3}   \* \{0, 1, 2\} - all elementse less than 3
j == Cardinality(c)     \* 5 - the number of elements in c
k == c \ d              \* \{0, 1, 3, 4\} - c substracts d
\end{tla}
\begin{tlatex}
\@x{ a \.{\defeq} \{ 0 ,\, 1 ,\, 2 \}}%
\@x{ b \.{\defeq} \{ 2 ,\, 3 ,\, 4 \}}%
\@x{ c \.{\defeq} a \.{\cup} b\@s{32.8}}%
\@y{%
  \{0, 1, 2, 3, 4\}
}%
\@xx{}%
\@x{ d \.{\defeq} a \.{\cap} b\@s{32.8}}%
\@y{%
  \{2\}
}%
\@xx{}%
\@x{ e \.{\defeq} \E\, x \.{\in} c \.{:} x \.{>} 3\@s{32.8}}%
\@y{%
  TRUE - because 4 in c is bigger than 3
}%
\@xx{}%
\@x{ f \.{\defeq} \E\, x \.{\in} c \.{:} x \.{>} 5\@s{32.8}}%
\@y{%
  FALSE - nothing in c is bigger than 5
}%
\@xx{}%
\@x{ g \.{\defeq} \A\, x \.{\in} c \.{:} x \.{<} 3\@s{32.8}}%
\@y{%
  FALSE - not all elements in c are smaller than 3
}%
\@xx{}%
\@x{ h \.{\defeq} \A\, x \.{\in} c \.{:} x \.{<} 5\@s{32.8}}%
\@y{%
  TRUE - all elements in c are smaller than 3
}%
\@xx{}%
\@x{ i \.{\defeq} \{ x \.{\in} c \.{:} x \.{<} 3 \}\@s{32.8}}%
\@y{%
  \{0, 1, 2\} - all elementse less than 3
}%
\@xx{}%
\@x{ j \.{\defeq} Cardinality ( c )\@s{32.8}}%
\@y{%
  5 - the number of elements in c
}%
\@xx{}%
\@x{ k \.{\defeq} c \.{\,\backslash\,} d\@s{32.8}}%
\@y{%
  \{0, 1, 3, 4\} - c substracts d
}%
\@xx{}%
\end{tlatex}

\section{Tuple}

\begin{tla}
A == <<0, 1, 2>>                    
B == <<2, 3, 4>>
C == A \o B                         \* tuple: 0, 1, 2, 2, 3, 4
D == Len(C)                         \* 6
E == \A x \in 1..Len(C) : C[x] # 10 \* TRUE - every C[x] is not 10
                                    \* First tuple element is at index 1 (not 0)
F == \E x \in 1..Len(C) : C[x] = 2  \* TRUE - there exists a C[x] that is 2
G == {x \in 1..Len(C) : C[x] = 2}   \* \{3, 4\} - when index is 3 or 4, C[x] = 2
\end{tla}
\begin{tlatex}
\@x{ A \.{\defeq} {\langle} 0 ,\, 1 ,\, 2 {\rangle}}%
\@x{ B \.{\defeq} {\langle} 2 ,\, 3 ,\, 4 {\rangle}}%
\@x{ C \.{\defeq} A \.{\circ} B\@s{98.39}}%
\@y{%
  tuple: 0, 1, 2, 2, 3, 4
}%
\@xx{}%
\@x{ D \.{\defeq} Len ( C )\@s{98.39}}%
\@y{%
  6
}%
\@xx{}%
 \@x{ E \.{\defeq} \A\, x \.{\in} 1 \.{\dotdot} Len ( C ) \.{:} C [ x ]
 \.{\neq} 10\@s{98.39}}%
\@y{%
  TRUE - every C[x] is not 10
}%
\@xx{}%
\@x{\@s{98.39}}%
\@y{%
  First tuple element is at index 1 (not 0)
}%
\@xx{}%
 \@x{ F \.{\defeq} \E\, x \.{\in} 1 \.{\dotdot} Len ( C ) \.{:} C [ x ] \.{=}
 2\@s{98.39}}%
\@y{%
  TRUE - there exists a C[x] that is 2
}%
\@xx{}%
 \@x{ G \.{\defeq} \{ x \.{\in} 1 \.{\dotdot} Len ( C ) \.{:} C [ x ] \.{=} 2
 \}\@s{98.39}}%
\@y{%
  \{3, 4\} - when index is 3 or 4, C[x] = 2
}%
\@xx{}%
\end{tlatex}

\section{Function}

\begin{tla}
SetA == {"a", "b", "c"}
SetB == {"c", "d", "e"}

\* Create a mapping with keys a, b, c with values 0, 0, 0
a == [k \in SetA |-> 0]
b == [k \in SetB |-> 1]
\* Concatenate 
c == a @@ b
\* Subtraction
d == [x \in (DOMAIN c \ DOMAIN b) |-> c[x]]
\* Create a mapping with keys a, b, c with values {}, {}, {}
e == [k \in SetA |-> {}]
\* Create a mapping that is the same as e, except key a's value is {"a", "b", "c"}
f == [e EXCEPT !["a"] = {"a", "b", "c"}] 

\end{tla}
\begin{tlatex}
\@x{ SetA \.{\defeq} \{\@w{a} ,\,\@w{b} ,\,\@w{c} \}}%
\@x{ SetB \.{\defeq} \{\@w{c} ,\,\@w{d} ,\,\@w{e} \}}%
\@pvspace{8.0pt}%
\@x{}%
\@y{%
  Create a mapping with keys a, b, c with values 0, 0, 0
}%
\@xx{}%
\@x{ a \.{\defeq} [ k \.{\in} SetA \.{\mapsto} 0 ]}%
\@x{ b \.{\defeq} [ k \.{\in} SetB \.{\mapsto} 1 ]}%
\@x{}%
\@y{%
  Concatenate 
}%
\@xx{}%
\@x{ c \.{\defeq} a \.{\,@@\,} b}%
\@x{}%
\@y{%
  Subtraction
}%
\@xx{}%
 \@x{ d \.{\defeq} [ x \.{\in} ( {\DOMAIN} c \.{\,\backslash\,} {\DOMAIN} b )
 \.{\mapsto} c [ x ] ]}%
\@x{}%
\@y{%
  Create a mapping with keys a, b, c with values {}, {}, {}
}%
\@xx{}%
\@x{ e \.{\defeq} [ k \.{\in} SetA \.{\mapsto} \{ \} ]}%
\@x{}%
\@y{%
 Create a mapping that is the same as e, except key a's value is {"a", "b",
 "c"}
}%
\@xx{}%
 \@x{ f \.{\defeq} [ e {\EXCEPT} {\bang} [\@w{a} ] \.{=} \{\@w{a} ,\,\@w{b}
 ,\,\@w{c} \} ]}%
\@pvspace{8.0pt}%
\end{tlatex}
